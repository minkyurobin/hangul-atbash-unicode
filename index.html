<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>한글 아토바쉬 암호기</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Noto Sans KR 구글폰트 -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet" />
  <style>
    /* 기본 초기화 */
    * {
      box-sizing: border-box;
      margin: 0; padding: 0;
    }
    body, html {
      height: 100%;
      font-family: 'Noto Sans KR', sans-serif;
      background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?ixlib=rb-4.0.3&auto=format&fit=crop&w=1470&q=80') no-repeat center center fixed;
      background-size: cover;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #ddd;
    }
    /* 글래스모피즘 박스 */
    .container {
      background: rgba(30, 16, 60, 0.6);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 1.5rem;
      padding: 2.5rem 3rem;
      width: 100%;
      max-width: 720px;
      box-shadow: 0 0 40px rgba(80, 50, 160, 0.7);
      border: 1px solid rgba(180, 160, 240, 0.25);
    }
    h1 {
      font-weight: 700;
      font-size: 2.5rem;
      margin-bottom: 1rem;
      color: #c8bfff;
    }
    p.description {
      font-weight: 500;
      margin-bottom: 2rem;
      color: #b0a9dc;
    }
    label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #aaa6d2;
    }
    select, textarea {
      width: 100%;
      padding: 1rem 1.1rem;
      font-size: 1.1rem;
      margin-bottom: 1.7rem;
      border-radius: 1rem;
      border: none;
      background: rgba(100, 80, 200, 0.35);
      color: #eee;
      box-shadow: inset 0 0 10px rgba(110, 90, 230, 0.6);
      font-weight: 500;
      resize: vertical;
      text-align: left;  /* 왼쪽 정렬 */
      font-family: 'Noto Sans KR', sans-serif;
      transition: background-color 0.3s ease;
    }
    select:focus, textarea:focus {
      outline: none;
      background: rgba(130, 110, 255, 0.7);
      box-shadow: 0 0 12px rgba(150, 130, 255, 0.9);
      color: #fff;
    }
    button {
      width: 100%;
      padding: 1.3rem 0;
      font-size: 1.2rem;
      font-weight: 700;
      color: #fff;
      background: linear-gradient(135deg, #6f42c1, #9370db);
      border: none;
      border-radius: 1.2rem;
      cursor: pointer;
      box-shadow: 0 6px 20px rgba(120, 90, 230, 0.7);
      transition: background 0.3s ease, transform 0.25s ease;
      font-family: 'Noto Sans KR', sans-serif;
    }
    button:hover {
      background: linear-gradient(135deg, #9370db, #8a54e7);
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(140, 110, 255, 0.9);
    }
    #output {
      background: rgba(90, 60, 170, 0.3);
      border-radius: 1.2rem;
      min-height: 140px;
      padding: 1.4rem 1.6rem;
      font-size: 1.2rem;
      color: #eee;
      white-space: pre-wrap;
      user-select: text;
      margin-top: 0.3rem;
      line-height: 1.5;
      font-weight: 500;
      font-family: 'Noto Sans KR', sans-serif;
      text-align: left; /* 왼쪽 정렬 */
      box-shadow: inset 0 0 15px rgba(120, 90, 230, 0.7);
    }
    .footer {
      margin-top: 2rem;
      font-size: 0.9rem;
      color: #b0a9dc;
      text-align: center;
      user-select: none;
    }
    /* 반응형 */
    @media (max-width: 480px) {
      h1 {
        font-size: 1.9rem;
      }
      #output {
        font-size: 1rem;
      }
    }
    /* 복사 버튼 별도 */
    #copyBtn {
      margin-top: 0.7rem;
      background: #7c6ad8;
      font-weight: 600;
      font-size: 1rem;
      border-radius: 1rem;
      padding: 0.7rem 1rem;
      box-shadow: 0 4px 12px rgba(120, 90, 230, 0.7);
      transition: background 0.3s ease;
      cursor: pointer;
      color: #fff;
      user-select: none;
    }
    #copyBtn:hover {
      background: #9b85f8;
    }
  </style>
</head>
<body>
  <main class="container" role="main" aria-label="한글 아토바쉬 암호기">
    <h1>한글 아토바쉬 암호기</h1>
    <p class="description">초·중·종성 자모 포함 아토바쉬 암호 변환기입니다.</p>

    <label for="method">암호화 방식 선택</label>
    <select id="method" aria-describedby="methodHelp" aria-label="암호화 방식 선택">
      <option value="unicode">유니코드 완성형 대칭 치환</option>
      <option value="jamo">초성·중성·종성 자모 대칭 치환</option>
    </select>

    <label for="input">원문 입력</label>
    <textarea id="input" placeholder="한글 문장을 입력하세요..." rows="5" aria-multiline="true"></textarea>

    <button onclick="convert()" aria-label="아토바쉬 변환 실행">변환하기</button>

    <label for="output">변환 결과</label>
    <div id="output" tabindex="0" aria-live="polite" aria-atomic="true"></div>
    <button id="copyBtn" onclick="copyOutput()" aria-label="변환 결과 복사">복사하기</button>

    <section aria-label="변환 원리 설명" style="margin-top:2rem; color:#b5a9de; font-size:0.9rem; line-height:1.4;">
      <h2 style="font-weight:600; margin-bottom:0.5rem; color:#d4cfff;">변환 원리</h2>
      <p>
        • <strong>유니코드 완성형 대칭 치환:</strong> 한글 완성형 유니코드 범위 내 글자를 시작(0xAC00)부터 끝(0xD7A3)까지 대칭 위치의 문자로 변환합니다.<br/>
        • <strong>초성·중성·종성 자모 대칭 치환:</strong> 한글을 초성, 중성, 종성으로 분해한 뒤 각 자모 배열의 대칭 위치 자모로 변환 후 재조합합니다.<br/>
        • <strong>특수문자 및 한글 외 문자:</strong> 변환하지 않고 원문 그대로 유지됩니다.
      </p>
    </section>

    <div class="footer">© 2025 제민규의 아토바쉬 암호기</div>
  </main>

  <script>
    // 초성, 중성, 종성 자모 배열 (받침 포함)
    const CHO = ["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"];
    const JUNG = ["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ","ㅘ","ㅙ","ㅚ","ㅛ","ㅜ","ㅝ","ㅞ","ㅟ","ㅠ","ㅡ","ㅢ","ㅣ"];
    const JONG = ["","ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"];

    const HANGUL_START = 0xAC00;
    const HANGUL_END = 0xD7A3;

    // 유니코드 완성형 대칭 변환 함수
    function atbashUnicode(ch) {
      const code = ch.charCodeAt(0);
      if (code >= HANGUL_START && code <= HANGUL_END) {
        const offset = code - HANGUL_START;
        const mirrorOffset = (HANGUL_END - HANGUL_START) - offset;
        return String.fromCharCode(HANGUL_START + mirrorOffset);
      }
      return ch;
    }

    // 자모 분해 후 대칭 변환, 재조합 함수
    function atbashJamo(ch) {
      const code = ch.charCodeAt(0);
      if (code < HANGUL_START || code > HANGUL_END) return ch;

      const offset = code - HANGUL_START;
      const jong = offset % 28;
      const jung = Math.floor(offset / 28) % 21;
      const cho = Math.floor(offset / (28 * 21));

      const newCho = CHO[CHO.length - 1 - cho];
      const newJung = JUNG[JUNG.length - 1 - jung];
      const newJong = JONG[JONG.length - 1 - jong];

      const newChoIdx = CHO.indexOf(newCho);
      const newJungIdx = JUNG.indexOf(newJung);
      const newJongIdx = JONG.indexOf(newJong);

      const newCode = HANGUL_START + (newChoIdx * 21 * 28) + (newJungIdx * 28) + newJongIdx;
      return String.fromCharCode(newCode);
    }

    function convert() {
      const method = document.getElementById("method").value;
      const input = document.getElementById("input").value;
      let output = "";

      for (let ch of input) {
        output += (method === "unicode") ? atbashUnicode(ch) : atbashJamo(ch);
      }

      document.getElementById("output").textContent = output;
    }

    function copyOutput() {
      const outputDiv = document.getElementById("output");
      if (!outputDiv.textContent) return alert("복사할 변환 결과가 없습니다.");
      navigator.clipboard.writeText(outputDiv.textContent).then(() => {
        alert("변환 결과가 복사되었습니다!");
      }, () => {
        alert("복사 실패! 브라우저에서 클립보드 접근 권한을 허용해주세요.");
      });
    }
  </script>
</body>
</html>
